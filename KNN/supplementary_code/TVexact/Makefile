## Makefile libTVE
##  
##-----------------------------------------------------------
## DO NOT EDIT BY HAND
## Autogenerated by ./configure.
## If something is wrong, fix ./configure and run it again. 
##-----------------------------------------------------------
##
## GREYC - IMAGE
## 6, boulevard Maréchal Juin 14050 CAEN.
## email : Jalal.Fadili@greyc.ensicaen.fr
##

RM          = rm -f
AR          = ar 
ARFLAGS     = lrcv
RANLIB      = ranlib
CXX         = g++
CXXFLAGS    = -O2 -ffast-math
CXXFLAGSOP  = $(CXXFLAGS) 
MEX         = /Applications/MATLAB_R2013a.app/bin/mex
MEXFLAGS    = 
LD          = g++
LDFLAGSLIB  =  -dynamiclib -dynamic -fno-common -flat_namespace -undefined suppress
LDFLAGSOP   =  -L. -lTVE 
PPP         = 
MAKE        = make
DYN_LIB	    = ./libTVE.dylib
STATIC_LIB  = ./libTVE.a

OBJ= \
	    graph.o \
	    graphtv.o \
	    graph_tv_solver.o \
	    tvh16-exact.o \
	    tvh-exact.o \
	    maxflow.o

TARGETS=

MEXTARGETS= \
	    graphtv_mex \
	    tvexact_mex

# Avoid removing intermediates files.
.PRECIOUS: %.cc

.IGNORE:

.PHONY: all clean cleandist distclean

all: lib matlab

matlab: $(MEXTARGETS)

FORCE:

clean:
	-$(RM) $(OBJ)

cleandist: distclean

distclean: clean
	$(RM) $(TARGETS)
	-$(RM) $(MEXTARGETS)
	-$(RM) $(DYN_LIB)
	-$(RM) $(STATIC_LIB)
	-$(RM) $(OBJ)

lib: $(DYN_LIB) $(STATIC_LIB)

$(DYN_LIB): $(OBJ)
	$(RM) $@
	$(LD) -o $@ $(LDFLAGSLIB) $(OBJ)
	chmod 755 $@

$(STATIC_LIB): $(OBJ)
	$(RM) $@
	$(AR) $(ARFLAGS) $@ $(OBJ)
	$(RANLIB) $(STATIC_LIB)
	chmod 644 $@
	

#
# dependencies :
#

%_mex: %_mex.cpp
	$(MEX) -outdir . $< $(MEXFLAGS) $(STATIC_LIB)
	
%_mex: %_mex.cpp
	$(MEX) -outdir . $< $(MEXFLAGS) $(STATIC_LIB)
